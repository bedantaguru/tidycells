% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/core_classes.R
\docType{class}
\name{cells-class}
\alias{cells-class}
\alias{sheets-class}
\title{The \code{cells} and \code{sheets} Class Structures}
\description{
The two primary data structures in this system are the \code{cells}
and \code{sheets} classes. They provide a standardized, tidy format for
representing tabular data. The fundamental building block is the \code{cells}
object, which evolves through different processing stages.
}
\section{Recognized Content Formats}{
 Throughout the system, cell content is
classified into one of the following recognized formats: \code{"numeric"},
\code{"character"}, \code{"logical"}, \code{"categorical"}, \code{"date"}, \code{"time"} or
\code{"blank"}.
}

\section{\code{cells} Structure and Value-Attribute Classification}{
 A \code{cells}
object is a \code{data.frame} representing data from a single sheet. Its
structure evolves as it is processed.

\strong{1. Initial State (Post-Reading)}

After initial reading from a source, a \code{cells} object contains the
following base columns:
\itemize{
\item \code{row}, \code{col}: An integer pair uniquely identifying each cell's position.
\item \code{data_type}: The type as read or inferred from the source (e.g., from Excel).
Its value will be one of the Recognized Content Formats.
\item \code{value}: The raw cell content, always stored as a character string.
\item \code{sheet} (optional): If present, a single, non-NA value identifying the source sheet.
}

\strong{2. Processed State (Post-Value-Attribute Classification)}

The value-attribute classification process analyzes cell content and
context to determine its role in the table. This augments the \code{cells}
object with the following columns:
\itemize{
\item \code{type}: The re-evaluated content type, based on a deeper examination
of the cell's content. Like \code{data_type}, its value is one of the Recognized
Content Formats.
\item \code{PoA} (Probability of Attribute): A numeric value \verb{>= 0} representing
the probability of the cell being an attribute (e.g., a header).
\item \code{PoV} (Probability of Value): A numeric value \verb{>= 0} representing the
probability of the cell being a data value.
}
The constraint \code{PoA + PoV <= 1} must hold for each cell. The classification
process uses the following heuristics regarding content types:
\itemize{
\item \strong{Numeric}: These cells have a very high probability of being
values (\code{PoV}). \item \strong{Categorical}: These cells can be either
attributes or values, and their probabilities depend on context. \code{Logical}
is considered a special, binary
case of the \code{categorical} type.
\item \strong{Date & Time}: Like categorical data, these cells often have a
positive probability of being both attributes (e.g., a column header like
"2023 Sales") and values.
\item \strong{Character}: This is a general super-type. If content does not
fit any other format, it is classified as character and typically has a
higher probability of being an attribute (\code{PoA}).
\item \strong{Blank}: These cells are empty or contain only whitespace or
irrelevant information, and are classified as \code{"blank"} with both \code{PoA} and
\code{PoV} equal to 0.
}
}

\section{\code{sheets} Structure}{

A valid \code{sheets} object is a \code{list} with:
\itemize{
\item Only valid \code{cells} objects as elements.
\item Unique, non-empty names for each sheet.
}
}

\seealso{
\code{\link[=as_cells]{as_cells()}}, \code{\link[=as_sheets]{as_sheets()}}
}
